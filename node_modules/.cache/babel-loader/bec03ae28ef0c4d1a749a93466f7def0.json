{"ast":null,"code":"import _regeneratorRuntime from\"/home/brandonzpb/Documents/projects/custom/creatures-of-habit/creatures-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/brandonzpb/Documents/projects/custom/creatures-of-habit/creatures-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _defineProperty from\"/home/brandonzpb/Documents/projects/custom/creatures-of-habit/creatures-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/home/brandonzpb/Documents/projects/custom/creatures-of-habit/creatures-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/home/brandonzpb/Documents/projects/custom/creatures-of-habit/creatures-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useContext}from'react';import{Link,Route,Redirect}from'react-router-dom';import userService from'../../services/userService';import{UserContext}from'../../contexts/UserContext';import'./user.css';var ResetCode=function ResetCode(){var _useContext=useContext(UserContext),reset=_useContext.reset,setReset=_useContext.setReset;var _useState=useState({code:''}),_useState2=_slicedToArray(_useState,2),form=_useState2[0],setForm=_useState2[1];var _useState3=useState({upset:false}),_useState4=_slicedToArray(_useState3,2),error=_useState4[0],setError=_useState4[1];var handleChange=function handleChange(event){var _event$target=event.target,name=_event$target.name,value=_event$target.value;setForm(_objectSpread(_objectSpread({},form),{},_defineProperty({},name,value)));};var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(event){var codeMatches;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:event.preventDefault();setError(_objectSpread(_objectSpread({},error),{},{upset:false}));if(!form.code.trim()){_context.next=13;break;}_context.next=5;return userService.postResetCode(form.code,reset.resetToken);case 5:codeMatches=_context.sent;if(!codeMatches){_context.next=10;break;}return _context.abrupt(\"return\",setReset(_objectSpread(_objectSpread({},reset),{},{code:form.code})));case 10:return _context.abrupt(\"return\",setError(_objectSpread(_objectSpread({},error),{},{upset:true})));case 11:_context.next=14;break;case 13:return _context.abrupt(\"return\",setError(_objectSpread(_objectSpread({},error),{},{upset:true})));case 14:case\"end\":return _context.stop();}}},_callee);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();var renewCode=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var resetToken;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return userService.getResetCode(reset.email);case 2:resetToken=_context2.sent;setReset(_objectSpread(_objectSpread({},reset),{},{resetToken:resetToken.reset_token}));case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function renewCode(){return _ref2.apply(this,arguments);};}();if(reset.code){return/*#__PURE__*/React.createElement(Route,{exact:true,path:\"/user/reset/code\"},/*#__PURE__*/React.createElement(Redirect,{to:\"/user/reset/password\"}));}if(!reset.resetToken){return/*#__PURE__*/React.createElement(Route,{exact:true,path:\"/user/reset/code\"},/*#__PURE__*/React.createElement(Redirect,{to:\"/\"}));}return/*#__PURE__*/React.createElement(\"div\",{className:\"reset-code-form\"},/*#__PURE__*/React.createElement(Link,{to:\"/\"},/*#__PURE__*/React.createElement(\"p\",{className:\"return-home-link\"},\"Return Home\")),/*#__PURE__*/React.createElement(\"form\",{onSubmit:handleSubmit},/*#__PURE__*/React.createElement(\"label\",null,\"Enter code below: \"),/*#__PURE__*/React.createElement(\"input\",{type:\"text\",name:\"code\",value:form.code,onChange:handleChange,style:{border:error.upset?'2px solid red':'none'}}),/*#__PURE__*/React.createElement(\"button\",{className:\"submit-code-btn\"},\"Submit Code\")),/*#__PURE__*/React.createElement(\"div\",{className:\"resend-code\"},/*#__PURE__*/React.createElement(\"span\",{className:\"resend-code-text\"},\"Need a new code?\")),/*#__PURE__*/React.createElement(\"button\",{onClick:renewCode,className:\"resend-code-btn\"},\"Resend Code\"));};export default ResetCode;","map":{"version":3,"sources":["/home/brandonzpb/Documents/projects/custom/creatures-of-habit/creatures-frontend/src/components/user/ResetCode.js"],"names":["React","useState","useContext","Link","Route","Redirect","userService","UserContext","ResetCode","reset","setReset","code","form","setForm","upset","error","setError","handleChange","event","target","name","value","handleSubmit","preventDefault","trim","postResetCode","resetToken","codeMatches","renewCode","getResetCode","email","reset_token","border"],"mappings":"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","sourcesContent":["import React, { useState, useContext } from 'react';\nimport { Link, Route, Redirect } from 'react-router-dom';\nimport userService from '../../services/userService';\nimport { UserContext } from '../../contexts/UserContext';\nimport './user.css';\n\nconst ResetCode = () => {\n  const { reset, setReset } = useContext(UserContext);\n\n  const [form, setForm] = useState({ code: '' });\n\n  const [error, setError] = useState({ upset: false });\n\n  const handleChange = event => {\n    const { name, value } = event.target;\n\n    setForm({\n      ...form,\n      [name]: value\n    });\n  }\n\n  const handleSubmit = async (event) => {\n    event.preventDefault();\n\n    setError({\n      ...error,\n      upset: false\n    });\n\n    if (form.code.trim()) {\n      const codeMatches = await userService.postResetCode(form.code, reset.resetToken);\n\n      if (codeMatches) {\n        return setReset({\n          ...reset,\n          code: form.code\n        });\n      } else {\n        return setError({\n          ...error,\n          upset: true\n        });\n      }\n    } else {\n      return setError({\n        ...error,\n        upset: true\n      });\n    }\n  }\n\n  const renewCode = async () => {\n    const resetToken = await userService.getResetCode(reset.email);\n\n    setReset({\n      ...reset,\n      resetToken: resetToken.reset_token\n    });\n  }\n\n  if (reset.code) {\n    return (\n      <Route exact path=\"/user/reset/code\">\n        <Redirect to=\"/user/reset/password\" />\n      </Route>\n    )\n  }\n\n  if (!reset.resetToken) {\n    return (\n      <Route exact path=\"/user/reset/code\">\n        <Redirect to=\"/\" />\n      </Route>\n    )\n  }\n\n  return (\n    <div className=\"reset-code-form\">\n      <Link to=\"/\">\n        <p className=\"return-home-link\">Return Home</p>\n      </Link>\n      <form onSubmit={handleSubmit}>\n        <label>Enter code below: </label>\n        <input \n          type=\"text\"\n          name=\"code\"\n          value={form.code}\n          onChange={handleChange}\n          style={{\n            border: error.upset ? '2px solid red' : 'none'\n          }}\n        />\n        <button className=\"submit-code-btn\">Submit Code</button>\n      </form>\n\n      <div className=\"resend-code\">\n        <span className=\"resend-code-text\">Need a new code?</span>\n      </div>\n      <button onClick={renewCode} className=\"resend-code-btn\">Resend Code</button>\n    </div>\n  )\n}\n\nexport default ResetCode;\n"]},"metadata":{},"sourceType":"module"}