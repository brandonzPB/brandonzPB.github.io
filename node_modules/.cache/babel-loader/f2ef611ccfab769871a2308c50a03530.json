{"ast":null,"code":"import _slicedToArray from\"/home/brandonzpb/Documents/projects/custom/creatures-of-habit/creatures-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useContext}from'react';import{CreatureContext}from'../../contexts/CreatureContext';import{UserContext}from'../../contexts/UserContext';import*as stats from'../../modules/stats';import CreatureDisplay from'./CreatureDisplay';import'./creature.css';import*as streakMethods from'../../modules/streak';var lvlUpMusicSrc=require('../../sounds/level-up.mp3');var levelUpSound=new Audio(lvlUpMusicSrc);var evolveMusicSrc=require('../../sounds/evolve.mp3');var evolveSound=new Audio(evolveMusicSrc);var Creature=function Creature(_ref){var creature=_ref.creature;var _useContext=useContext(CreatureContext),displayObjectives=_useContext.displayObjectives,showCreatureObjectives=_useContext.showCreatureObjectives,expUpdate=_useContext.expUpdate,toggleExpUpdate=_useContext.toggleExpUpdate,finish=_useContext.finish;var _useContext2=useContext(UserContext),user=_useContext2.user,userDispatch=_useContext2.userDispatch;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),levelUpdate=_useState2[0],setLevelUpdate=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),evolve=_useState4[0],setEvolve=_useState4[1];var pokeball=!creature.pokeball_number?13:creature.pokeball_number<14?13// pokeball\n:creature.pokeball_number===14?1// greatball\n:creature.pokeball_number===15?0:11;// ultraball : masterball\nvar img=require(\"../../images/pokeballs/\".concat(pokeball,\".png\"));var toggleLevelUpdate=function toggleLevelUpdate(){setLevelUpdate(!levelUpdate);};var toggleEvolve=function toggleEvolve(){setEvolve(!evolve);};/// AUTO-UPDATE HOOKS ///\n// HOOK: EXP + STREAK UPDATES\nuseEffect(function(){if(!expUpdate)return;var streak=streakMethods.checkCreatureStreak(user.newDay,creature);if(streak==='increment'||creature.streak_count===0)streakMethods.updateCreatureStreak(creature,userDispatch,finish);if(creature.exp>=creature.exp_goal||creature.is_noob){levelUpSound.currentTime=1;levelUpSound.play();var newLevel=creature.level+1;userDispatch({type:'LEVEL_UP',creature:{id:creature.id,level:newLevel}});finish('creature',creature,'stats');return toggleLevelUpdate();}toggleExpUpdate();},[creature.exp]);// HOOK: NEW LEVEL UPDATES\nuseEffect(function(){if(!levelUpdate)return;var timer=setTimeout(function(){var difficulty=stats.getCreatureDifficulty(creature.purpose,creature.level);var multiplier=stats.getExpMultiplier(creature.level);userDispatch({type:'UPGRADE_MULTIPLIERS',creature:{id:creature.id,difficulty:difficulty,multiplier:multiplier}});finish('creature',creature,'stats');var prevGoal=creature.is_noob?1:creature.exp_goal;var newGoal=creature.is_noob?9:stats.getExpGoal(creature.level,difficulty);userDispatch({type:'LEVEL_UPDATES',creature:{id:creature.id,prevGoal:prevGoal,newGoal:newGoal}});finish('creature',creature,'stats');toggleExpUpdate();toggleLevelUpdate();if(creature.level===15||creature.level===30||creature.level===50||creature.level==80){var newPokeball=creature.level===30?14:creature.level===50?15:creature.level===80?16:creature.pokeball_number;userDispatch({type:'UPDATE_POKEBALL',creature:{id:creature.id,newPokeball:newPokeball}});finish('creature',creature,'stats');return toggleEvolve();}},100);return function(){return clearTimeout(timer);};},[levelUpdate]);// HOOK: EVOLVE\nuseEffect(function(){if(!evolve)return;var nextCreatureIndex=creature.evolutions.findIndex(function(being){return being===creature.creature;})+1;if(!creature.evolutions[nextCreatureIndex])return toggleEvolve();if(creature.evolutions[nextCreatureIndex]==='none'){var newEvoLine=creature.evolutions;newEvoLine.splice(nextCreatureIndex,1);console.log('newEvoLine',newEvoLine);return toggleEvolve();}setTimeout(function(){evolveSound.play();var nextCreature=creature.evolutions[nextCreatureIndex];userDispatch({type:'EVOLVE',creature:{id:creature.id,nextCreature:nextCreature}});finish('creature',creature,'stats');return toggleEvolve();},800);},[evolve]);// Sends creature id to context and allows for\n// The selected creature's objectives to be shown\nvar displayCreatureObjectives=function displayCreatureObjectives(){showCreatureObjectives(creature.id);finish('creature',creature,'stats');};return/*#__PURE__*/React.createElement(\"div\",{className:\"creature\",style:{backgroundImage:\"linear-gradient(rgba(255, 255, 255, 0.3), rgba(255, 255, 255, 0.6)), url(\".concat(img,\")\"),backgroundRepeat:'no-repeat',backgroundSize:'cover',backgroundPosition:'center'}},/*#__PURE__*/React.createElement(CreatureDisplay,{creature:creature,displayObjectives:displayObjectives,displayCreatureObjectives:displayCreatureObjectives}));};export default Creature;","map":{"version":3,"sources":["/home/brandonzpb/Documents/projects/custom/creatures-of-habit/creatures-frontend/src/components/creature/Creature.js"],"names":["React","useState","useEffect","useContext","CreatureContext","UserContext","stats","CreatureDisplay","streakMethods","lvlUpMusicSrc","require","levelUpSound","Audio","evolveMusicSrc","evolveSound","Creature","creature","displayObjectives","showCreatureObjectives","expUpdate","toggleExpUpdate","finish","user","userDispatch","levelUpdate","setLevelUpdate","evolve","setEvolve","pokeball","pokeball_number","img","toggleLevelUpdate","toggleEvolve","streak","checkCreatureStreak","newDay","streak_count","updateCreatureStreak","exp","exp_goal","is_noob","currentTime","play","newLevel","level","type","id","timer","setTimeout","difficulty","getCreatureDifficulty","purpose","multiplier","getExpMultiplier","prevGoal","newGoal","getExpGoal","newPokeball","clearTimeout","nextCreatureIndex","evolutions","findIndex","being","newEvoLine","splice","console","log","nextCreature","displayCreatureObjectives","backgroundImage","backgroundRepeat","backgroundSize","backgroundPosition"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useContext } from 'react';\nimport { CreatureContext } from '../../contexts/CreatureContext';\nimport { UserContext } from '../../contexts/UserContext';\nimport * as stats from '../../modules/stats';\nimport CreatureDisplay from './CreatureDisplay';\nimport './creature.css';\nimport * as streakMethods from '../../modules/streak';\n\nconst lvlUpMusicSrc = require('../../sounds/level-up.mp3');\nconst levelUpSound = new Audio(lvlUpMusicSrc);\n\nconst evolveMusicSrc = require('../../sounds/evolve.mp3');\nconst evolveSound = new Audio(evolveMusicSrc);\n\nconst Creature = ({ creature }) => {\n  const { displayObjectives, showCreatureObjectives, expUpdate, toggleExpUpdate, finish } = useContext(CreatureContext);\n  const { user, userDispatch } = useContext(UserContext);\n\n  const [levelUpdate, setLevelUpdate] = useState(false);\n  const [evolve, setEvolve] = useState(false);\n\n  const pokeball = (!creature.pokeball_number) ? 13\n    : (creature.pokeball_number < 14) ? 13 // pokeball\n    : (creature.pokeball_number === 14) ? 1 // greatball\n    : (creature.pokeball_number === 15) ? 0 : 11; // ultraball : masterball\n\n  const img = require(`../../images/pokeballs/${pokeball}.png`);\n\n  const toggleLevelUpdate = () => {\n    setLevelUpdate(!levelUpdate);\n  }\n\n  const toggleEvolve = () => {\n    setEvolve(!evolve);\n  }\n\n  /// AUTO-UPDATE HOOKS ///\n\n  // HOOK: EXP + STREAK UPDATES\n  useEffect(() => { \n    if (!expUpdate) return;\n    \n    const streak = streakMethods.checkCreatureStreak(user.newDay, creature);\n    if (streak === 'increment' || creature.streak_count === 0) streakMethods.updateCreatureStreak(creature, userDispatch, finish);\n\n    if (creature.exp >= creature.exp_goal || creature.is_noob) {\n      levelUpSound.currentTime = 1;\n        levelUpSound.play();\n        \n      const newLevel = creature.level + 1;\n\n      userDispatch({ type: 'LEVEL_UP', creature: { id: creature.id, level: newLevel }});\n\n      finish('creature', creature, 'stats');\n\n      return toggleLevelUpdate();\n    }\n\n     toggleExpUpdate();\n  }, [creature.exp]);\n\n  // HOOK: NEW LEVEL UPDATES\n  useEffect(() => {\n    if (!levelUpdate) return;\n\n    const timer = setTimeout(() => {\n      const difficulty = stats.getCreatureDifficulty(creature.purpose, creature.level);\n      const multiplier = stats.getExpMultiplier(creature.level);\n\n      userDispatch({ type: 'UPGRADE_MULTIPLIERS', creature: { id: creature.id, difficulty, multiplier }});\n\n      finish('creature', creature, 'stats');\n\n      const prevGoal = (creature.is_noob) ? 1 : creature.exp_goal;\n      const newGoal = (creature.is_noob) ? 9 : stats.getExpGoal(creature.level, difficulty);\n\n      userDispatch({ type: 'LEVEL_UPDATES', creature: {\n        id: creature.id,\n        prevGoal,\n        newGoal,\n      }});\n\n      finish('creature', creature, 'stats');\n\n      toggleExpUpdate();\n      toggleLevelUpdate();\n\n      if (creature.level === 15 || creature.level === 30 || creature.level === 50 || creature.level == 80) {\n        const newPokeball = (creature.level === 30) ? 14\n          : (creature.level === 50) ? 15 \n          : (creature.level === 80) ? 16 \n          : creature.pokeball_number;\n\n        userDispatch({ type: 'UPDATE_POKEBALL', creature: {\n          id: creature.id,\n          newPokeball\n        }});\n\n        finish('creature', creature, 'stats');\n\n        return toggleEvolve();\n      }\n    }, 100);\n\n    return () => clearTimeout(timer);\n  }, [levelUpdate]);\n\n  // HOOK: EVOLVE\n  useEffect(() => {\n    if (!evolve) return;\n    \n    const nextCreatureIndex = creature.evolutions.findIndex(being => being === creature.creature) + 1;\n    if (!creature.evolutions[nextCreatureIndex]) return toggleEvolve();\n\n    if (creature.evolutions[nextCreatureIndex] === 'none') {\n      let newEvoLine = creature.evolutions;\n        newEvoLine.splice(nextCreatureIndex, 1);\n      console.log('newEvoLine', newEvoLine);\n\n      return toggleEvolve();\n    }\n\n    setTimeout(() => {\n      evolveSound.play();\n\n      const nextCreature = creature.evolutions[nextCreatureIndex];\n\n      userDispatch({ type: 'EVOLVE', creature: {\n        id: creature.id,\n        nextCreature\n      }});\n\n      finish('creature', creature, 'stats');\n\n      return toggleEvolve();\n    }, 800);\n  }, [evolve]);\n\n  // Sends creature id to context and allows for\n  // The selected creature's objectives to be shown\n  const displayCreatureObjectives = () => {\n    showCreatureObjectives(creature.id);\n    finish('creature', creature, 'stats');\n  }\n\n  return (\n    <div className=\"creature\" style={{\n      backgroundImage: `linear-gradient(rgba(255, 255, 255, 0.3), rgba(255, 255, 255, 0.6)), url(${img})`,\n      backgroundRepeat: 'no-repeat',\n      backgroundSize: 'cover',\n      backgroundPosition: 'center',\n    }}>\n      <CreatureDisplay \n        creature={creature}\n        displayObjectives={displayObjectives}\n        displayCreatureObjectives={displayCreatureObjectives}\n      />\n    </div>\n  )\n}\n\nexport default Creature;\n"]},"metadata":{},"sourceType":"module"}